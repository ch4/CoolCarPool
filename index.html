<!DOCTYPE html><!--HTML5 doctype-->
<html>
<head>
  <title>CoolCarpool</title>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
    <link rel="stylesheet" type="text/css" href="jquery.mobile-1.3.2.min.css" />
  <style type="text/css">
    /* Prevent copy paste for all elements except text fields */
    *  { -webkit-user-select:none; -webkit-tap-highlight-color:rgba(255, 255, 255, 0); }
    input, textarea  { -webkit-user-select:text; }
    #mapcontent {padding:0px;}
  </style>
    
<script src='intelxdk.js'></script>
<!--    <script src='jquery-2.0.3.min.js'></script>-->
    <script src='jquery-1.9.1.min.js'></script>
    <script src='jquery.mobile-1.3.2.min.js'></script>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>
    <script type="text/javascript" src="jquery.ui.map.full.min.js"></script>
    <script type="text/javascript" src="jquery.ui.map.services.min.js"></script>
    <script type="text/javascript" src="jquery.ui.map.extensions.js"></script>
    <script type="text/javascript">
        /* This code is used to run as soon as Intel activates */
        var onDeviceReady=function(){
          //hide splash screen
          intel.xdk.device.hideSplashScreen();
        };
        document.addEventListener("intel.xdk.device.ready",onDeviceReady,false);
    </script>
    
    <script src='https://api.intel.com/sdk/js/v1/intel.cloudservices.js'></script>
<!--    intel auth services-->
    <script type="application/javascript">
        var userprofile;
        function initSuccessCallback (data){
            intel.profile.getUserProfile (function (data2) {$.mobile.changePage( '#main', { transition: 'fade'} );},
            function (data2) {intel.auth.login({
                    redirectUri: "http://ccp.parseapp.com/intelcallback.html",
                    name: "myLoginWindow",
                    specs: "location=1,status=1,scrollbars=1,width=700,height=400"
                },
                loginSuccessCallback,
                errorCallback
                );});
                
        }
        function loginSuccessCallback (data) {
            var authType = data.access_token.authentication_type;
//            document.getElementById("statusBox").innerHTML +=
//            "<br/>Login Success! Auth Type: " + authType;
            //alert("Login successful");
            intel.profile.getUserProfile (getUserProfileSuccessCallback,
            errorCallback);
        }
        function getUserProfileSuccessCallback (profile) {
//            document.getElementById("statusBox").innerHTML +=
//            "<br/>Get User Profile Success! User: "
//            + profile.basic.firstName;
            alert("Hello " + profile.basic.firstName);
            userprofile = profile;
            $.mobile.changePage( '#main', { transition: 'fade'} );
        }
        function errorCallback (error) {
            alert("Error: " + error.desc);
        }
        
        intel.auth.init({
                clientId: "TqsdmQDQa5AM09L38XogbIkNANF4mzxG",
                secretId: "lTJSWa9SftVIjeIX",
                scope: "user:details user:scope profile:full profile:basic location:basic"
            },
            initSuccessCallback,
            errorCallback
        );
        
    </script>
    
<!--    maps init-->
    
    <script type="application/javascript">
        var latitude = 37.339319;
        var longitude = -121.883183;
        var map;
        
        //var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
        var icons = {
          origin: {
            icon: 'http://maps.google.com/mapfiles/kml/paddle/red-circle.png'
          },
          people: {
            icon: 'http://maps.google.com/mapfiles/kml/shapes/man.png'
          },
          destination: {
            icon: 'http://maps.google.com/mapfiles/kml/paddle/stop.png'
          }
        };

        function initMap(){
            var initialLocation = new google.maps.LatLng(latitude, longitude);
            var myOptions = {
                zoom: 12, 
                center: initialLocation, 
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            
            map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
                    
            //phonegap geolocation call
            navigator.geolocation.getCurrentPosition(onSuccess, onError);
        }

        var onSuccess = function(position) {
            latitude = position.coords.latitude;
            longitude = position.coords.longitude;
            
            var myLatlng = new google.maps.LatLng(latitude,longitude);
            
            var marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                title: "current location"
            });
            map.setCenter(myLatlng);
            
            addOtherDudes(3);
        };
        
        function addOtherDudes (count) {
//            for(int i = 0; i < count; ++i){
//                
//            }
            
            var marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                title: "current location"
            });
        }

        function onError(error) {
                alert('code: '    + error.code    + '\n' + 'message: ' + error.message + '\n');
        }
    </script>
</head>
<body>

<!--    Login page-->
    <div class="coolcarpool" data-role="page" id="login">
		<div data-role="header" >
			<h1>Login</h1>
        </div>
        <div data-role="content" > 
<!--            content goes here-->
            <button onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Skip</button>
		</div>
	</div>
    
<!--    Home page-->
    <div class="coolcarpool" data-role="page" id="main">
		<div data-role="header" >
			<h1>CoolCarpool</h1>
			<button class="ui-btn-right" onclick="$.mobile.changePage( '#profile', { transition: 'fade'} )" data-icon="gear">Profile</button>
		</div>
        <div data-role="content" > 
<!--            content goes here-->
            <p>Nothing to see here...</p>
		</div>
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
                <ul>
                    <li><a href="#" class="ui-btn-active" onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Home</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#map', { transition: 'fade'} );onLoadMap();">Map</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#calendar', { transition: 'fade'} )">Calendar</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#testarea', { transition: 'fade'} )">Test Area</a></li>
                </ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
	</div>
    
<!--    Map page-->
    <div class="coolcarpool" data-role="page" id="map">
		<div data-role="header" >
            <a href="#" data-role="button" data-rel="back" data-icon="arrow-l">Back</a>
            <h1>Map</h1>
            <button class="ui-btn-right" onclick="$.mobile.changePage( '#profile', { transition: 'fade'} )" data-icon="gear">Profile</button>
        </div>
		<div data-role="content" id="mapcontent">
<!--            content goes here-->
            <div id="map_canvas" style="width:100%; height:100%;"></div>
            <script type="text/javascript">
                 
    //                                var myLatlng = new google.maps.LatLng(loc.latitude,loc.longitude);
    //
    //                                var marker = new google.maps.Marker({
    //                                    position: myLatlng,
    //                                    map: map,
    //                                    title: place.get("name")
    //                                });
                                           
                                
                function onLoadMap(){
                    $('#map_canvas').height($('#map').height()-30);
                    $('#map').on("pageshow", function() {
                        initMap();
                        
                        var origin = new google.maps.LatLng(latitude, longitude);
                        var myOptions = {
                          zoom: 12,
                          mapTypeId: google.maps.MapTypeId.ROADMAP,
                          center: origin
                        }
                    });
                }
            </script>    
		</div>
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
                <ul>
                    <li><a href="#" onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Home</a></li>
                    <li><a href="#" class="ui-btn-active" onclick="$.mobile.changePage( '#map', { transition: 'fade'} )">Map</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#calendar', { transition: 'fade'} )">Calendar</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#testarea', { transition: 'fade'} )">Test Area</a></li>
                </ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
	</div>
    
<!--    Calendar page-->
    <div class="coolcarpool" data-role="page" id="calendar">
		<div data-role="header" >
            <a href="#" data-role="button" data-rel="back" data-icon="arrow-l">Back</a>
            <h1>Calendar</h1>
            <button class="ui-btn-right" onclick="$.mobile.changePage( '#profile', { transition: 'fade'} )" data-icon="gear">Profile</button>
        </div>
        <div data-role="content" >
<!--            content goes here-->
		</div>
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
                <ul>
                    <li><a href="#" onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Home</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#map', { transition: 'fade'} );onLoadMap();">Map</a></li>
                    <li><a href="#" class="ui-btn-active" onclick="$.mobile.changePage( '#calendar', { transition: 'fade'} )">Calendar</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#testarea', { transition: 'fade'} )">Test Area</a></li>
                </ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
	</div>
    
    <!--    Profile page-->
    <div class="coolcarpool" data-role="page" id="profile">
		<div data-role="header" >
            <a href="#" data-role="button" data-rel="back" data-icon="arrow-l">Back</a>
            <h1>Profile</h1>
        </div>
        <div data-role="content" >
<!--            content goes here-->
		</div>
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
                <ul>
                    <li><a href="#" onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Home</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#map', { transition: 'fade'} );onLoadMap();">Map</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#calendar', { transition: 'fade'} )">Calendar</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#testarea', { transition: 'fade'} )">Test Area</a></li>
                </ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
	</div>
    
<!--    Test Page-->
    <div class="coolcarpool" data-role="page" id="testarea">
        <div data-role="header" >
            <a href="#" data-role="button" data-rel="back" data-icon="arrow-l">Back</a>
            <h1>Test Area</h1>
            <button class="ui-btn-right" onclick="$.mobile.changePage( '#profile', { transition: 'fade'} )" data-icon="gear">Profile</button>
        </div>
        <div data-role="content" >
            <h2>Test text is below:</h2>
            <span id="testspan"></span>
            <br><br>
    
            <h2>Test Functions</h2>
            <button onclick="$('#testarea #testspan').text('Hello World!')">Hello World</button>
            <button onclick="$('#testarea #testspan').text(AppMobi.device.uuid)">Get Device UUID</button>
            <button onclick="$('#testarea #testspan').text(AppMobi.device.name)">Get Device Name</button>
        </div>
        <div data-role="footer" data-position="fixed">
			<div data-role="navbar">
                <ul>
                    <li><a href="#" onclick="$.mobile.changePage( '#main', { transition: 'fade'} )">Home</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#map', { transition: 'fade'} );onLoadMap();">Map</a></li>
                    <li><a href="#" onclick="$.mobile.changePage( '#calendar', { transition: 'fade'} )">Calendar</a></li>
                    <li><a href="#" class="ui-btn-active" onclick="$.mobile.changePage( '#testarea', { transition: 'fade'} )">Test Area</a></li>
                </ul>
			</div><!-- /navbar -->
		</div><!-- /footer -->
    </div>
  <!-- content goes here-->
</body>
</html>
